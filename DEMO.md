# Ensemble Stars Music 卡面爬取工具 - 使用演示

## 🎯 功能概览

这是一个现代化的Web界面，用于爬取Gamerch「Ensemble Stars Music」卡面详情并导出为CSV文件。

## 🚀 启动方式

### 方法一：一键启动
```bash
python start_server.py
```

### 方法二：手动启动
```bash
pip install -r requirements.txt
python app.py
```

然后访问：http://localhost:5000

## 📖 使用流程

### 1. 启动页面
![启动页面](https://via.placeholder.com/800x400/4f46e5/ffffff?text=启动页面)

- **输入目录链接**：粘贴Gamerch活动目录页链接
- **自动验证**：系统会验证链接格式是否正确
- **一键分析**：点击"分析目录页"开始解析

**示例链接**：
```
https://gamerch.com/ensemble-star-music/895943
```

### 2. 活动选择页面
![活动页面](https://via.placeholder.com/800x400/059669/ffffff?text=活动选择页面)

#### 左侧活动列表
- 显示所有找到的活动
- 支持多选功能
- 实时搜索过滤
- 显示活动日期和类型

#### 右侧活动预览
- 点击活动查看详情
- 显示活动名称、日期、链接
- 预览活动相关信息

#### 操作按钮
- **全选/取消全选**：快速选择所有活动
- **开始爬取**：启动选中活动的爬取任务
- **返回**：回到启动页面

### 3. 爬取进度页面
![进度页面](https://via.placeholder.com/800x400/dc2626/ffffff?text=爬取进度)

#### 实时进度显示
- **进度条**：显示整体完成百分比
- **当前任务**：显示正在处理的活动
- **处理日志**：实时显示详细处理信息

#### 操作控制
- **取消爬取**：中途停止任务
- **下载结果**：完成后自动下载CSV文件

## 🎨 界面特色

### 现代设计
- **渐变背景**：美观的紫色渐变背景
- **卡片布局**：清晰的信息层次
- **动画效果**：流畅的过渡动画
- **图标支持**：Font Awesome图标库

### 响应式布局
- **桌面优化**：完美适配大屏幕
- **平板支持**：中等屏幕自适应
- **手机友好**：小屏幕优化布局

### 用户体验
- **实时反馈**：操作即时响应
- **错误提示**：友好的错误信息
- **加载状态**：清晰的加载指示
- **通知系统**：成功/错误通知

## 📊 输出格式

### CSV文件结构
```csv
活动名称,卡面名称,角色,稀有度,技能名称,技能描述,获取方式,活动日期
活动1,卡面1-1,角色1,☆5,技能1,技能描述,活动奖励,2024年10月
活动1,卡面1-2,角色2,☆4,技能2,技能描述,活动奖励,2024年10月
...
```

### 文件命名
- 格式：`es_cards_YYYYMMDD_HHMMSS.csv`
- 示例：`es_cards_20241020_143052.csv`
- 位置：`downloads/` 目录

## 🔧 技术特性

### 前端技术
- **HTML5**：语义化标记
- **CSS3**：现代样式和动画
- **JavaScript ES6+**：模块化代码
- **响应式设计**：移动端适配

### 后端技术
- **Flask**：轻量级Web框架
- **多线程**：并发处理任务
- **实时通信**：WebSocket风格的进度更新
- **文件管理**：自动清理和下载

### 数据处理
- **BeautifulSoup**：HTML解析
- **Requests**：HTTP请求
- **CSV导出**：标准格式输出
- **错误处理**：完善的异常管理

## 🛠️ 开发信息

### 项目结构
```
es/
├── index.html          # 主页面
├── styles.css          # 样式文件
├── script.js           # 前端逻辑
├── app.py             # Flask后端
├── start_server.py    # 启动脚本
├── test_api.py        # API测试
├── requirements.txt   # 依赖管理
├── downloads/         # 下载目录
└── es/               # 原有脚本
```

### API接口
- `POST /api/analyze` - 分析目录页
- `POST /api/crawl/start` - 开始爬取
- `GET /api/progress/<task_id>` - 查询进度
- `POST /api/cancel/<task_id>` - 取消任务
- `GET /api/download/<task_id>` - 下载结果
- `GET /api/tasks` - 任务列表

## 📝 注意事项

1. **网络连接**：需要稳定的网络连接访问Gamerch
2. **目标日期**：自动识别10日、14日、15日、25日及月末活动
3. **文件权限**：确保downloads目录有写入权限
4. **浏览器兼容**：推荐使用Chrome、Firefox、Edge等现代浏览器

## 🎉 完成！

现在你可以享受这个现代化、美观且功能完整的Ensemble Stars Music卡面爬取工具了！